var e=Object.defineProperty,t=("undefined"!=typeof require&&require,(t,i,r)=>(((t,i,r)=>{i in t?e(t,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[i]=r})(t,"symbol"!=typeof i?i+"":i,r),r));!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const i of e)if("childList"===i.type)for(const e of i.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var i="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAHsUlEQVR42u3dL48kRRQA8P4QG5KViJOHQmNQfAYcAkNCgsKQnOMDgCFYBMFwgvsABH0OB0FjELcaMdxwmdxMb/+tqtfd1f37JZW925qd2Z2Zev263tve5uXPn5wix/vf/Zk1xu7/WfPMyBjNwd3f35+fgxdRH1+Py3Oc+nHsNnmjb2H99M1HN2Pu/JIB4NScXo9Xp3+bf169+ffbYX54vqFz8faNvtsNBIEmMwicQoNA38J+9+vfb0Z7wffNrxcA3rzJ+xeA+a55GcD4ok8dEzKA9hiaj88Auhb23NEOAssEgIdHb+zL58wPz0sA4hZ/TwZQYpTPANqL/3oR9i32vtv88etXKwSAh6s39kPHAjDfNS8DWDQDOAUEgbIBIHfBrhsAHm6Obo8XgPn2vARABlBs8XcFgXVOAboWgPmueRlA+cVfXQawVgCYcpv0PYDTyDmweQEgLgO4CgIRi/9UPAMotfinLu5zkJgSfObWtd97+YX6vj6AI+wB1B8A+jYU2wFAHV8fgAxggU3A0ot/LL0fW/y3AUAdXx+ADCC0DLh0AJgy1PH1AagC7DQDmBcA1PH1AcgADpwBqOPrA5AB7KoMmH4KoI6vD+DwfQDHaARSx9cHoAqwQAYQVQZUa9cHcPAMIDIAXPYwnvd9HH0ClggA6vD6AA6cAURnAc9HgsB4AIjcBFSH1wdw8CpA6CZgkQwgPgCow+sDOGwVILoMWCYDKBUErhe/39fXByADqCQDuIzzAj6ProV9Pfrm/b6+PoAaM4BSQeD6/u7u7uZezmtqsIjJALoCQd/CHpv3+/r6AGrLAJqJF/wcu1Boc3tV4KbJvyho73zxDKD0UIfXB1BTBhDwscSVgYc+xmQApcb59/Mjh1q+PoCoDKAp83cBmgWCQLo9BAB1fn0AARnAaLCYeD9TF+3c+TKvXd/CffLL5zdj7vzyAUCdXx9AdgZQ/H5DFm1kBnBZ0O2F1l7wffPrBAB1fn0A2RlA1P2WXvxNWAbQtbDnjnYQWC4AqPPrA8g+UkdnAM3mgsC+AoA6vz6AzWYAzaYzgBKLvysIjN0u93HV+fUBFDhShwWX4G//VG0AON/m0kCU89jq/PoAtrpIgzOApuoM4HKb8+8fDD22Wr0+gBr3AGQAhU4B1PH1AVS6B1BXBrDVTUB1fH0AO8gAVAHU+fUBqALoA1Dn1wegD0AGoM6vD2D3VQB9AHGnAOr4+gC23QcQvLewjyqAOr8+AH0AO+8DUGvXB3DEDEAfwKPLgqvD6wOQARyuD0AdXh+AKsCBqwDq8PoA9AFU0gcQcUEQdXh9ADKAsIuBxF0TsNQlwdTh9QFUkgG8KH1/QVcEWuaagLGXBVeH1wewrQxg5gU/xxb91KsCz13c9V0VWB1eH0AtGUClfxdgm9757MPT9Ri6rXq8PgB24rLgn/zw8c0YCgTq9PoAWF/KXyd9tPjbC78rEHQHAHV6fQCsGgD+fvp00ugKANeL/9O/vv9/TA0C6vT6ANhIALg+yqcEgLHF3x8A1On1AbCJAHC90KcEgDlH/64goE6vD4CKM4AyAUCdXh8A1WcAU8dwAFCn1wdAlRlASgBQj9cHQKVVgJTF3w4C6vT6AKg8AMwJBNdf8zYAqNPrA6C6AHAJAu1sYOjf11/TvwegTq8PgCoCQDsYnMdv375t//3xyw8Gfy9AnV4fABsIAE1mK/AlAJwX/2WcF/9l9P8ugDq9PgB2IT0AqNPrA2A3QaBr9Kce6vT6AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAI7i1HL+VN9cez736089LrcZm5/6+O37m3r/U+en/r/rue96Pufc35qvX8rX5zx/a/1/7DmofvFv5Qkf+/5Kf/9TH2fK400JQKnff99jpPy8a7yeUz9f+/vx8AEg9/5zA8Dcxy8VAFLvd40MZMkFs3YAmPMaHW7xp74Bo45wKS9O19ExJYUrEQC6vnbqKUD75xjKMHJT2NxTpJQFFBkAhp6/qAPJ7gLAXjKAtU4BcjOAraS0Ua9XbgCI2iOa8jrtdvHbAyh7hIrMkJZ4fnMyhKjnt9Qmb6nv77ABIHcXvtQucWoVI/rnyz2CRZ3jznn+UjYZSx5hU08hcqsoUz6/2yoAcHDREXzuLmt0BhK1S1wyE1tqk22Jn6G2o2bXJuOcn7mqDGFuijfw4mZt+k1NQVPLfEttekYvnohz7CV2ydfcZc9Z0KXff1UGgJxd8rkRM7IxI3ITKTIDSD0X7vp8Trkyd5c8Yqe9ZJk3+r2/+wCQuvhL9CEseQqzVgDY6hssZ4GUKPMtESB22yewVIpY8n6WLkOVPFJt9Q125AygdDfj4QLAnLkS51Qr1fmz3wRbfpMcdQ8gNaNY+hRxtSrAUp1Yc9LEpmAr6hL3n7qbPLTZuubO+J6OkKlZR6mAAgAAAAAAAABQwn8pruDSr7jLvwAAAABJRU5ErkJggg==";class r{constructor(e,i,r){t(this,"w"),t(this,"h"),t(this,"values"),this.w=e,this.h=i,this.values=new Array(e*i);for(let t=0;t<i;t+=r)for(let i=0;i<e;i+=r)this.setSample(i,t,2*Math.random()-1);let A=r,s=1/e,l=1;do{const t=A/2;for(let r=0;r<i;r+=A)for(let i=0;i<e;i+=A){const e=(this.sample(i,r)+this.sample(i+A,r)+this.sample(i,r+A)+this.sample(i+A,r+A))/4+(2*Math.random()-1)*A*s;this.setSample(i+t,r+t,e)}for(let i=0;i<e;i+=A)for(let r=0;r<e;r+=A){const e=this.sample(r,i),l=this.sample(r+A,i),n=this.sample(r,i+A),h=this.sample(r+t,i+t),o=this.sample(r+t,i-t),a=this.sample(r-t,i+t),d=(e+l+h+o)/4+(2*Math.random()-1)*A*s*.5,c=(e+n+h+a)/4+(2*Math.random()-1)*A*s*.5;this.setSample(r+t,i,d),this.setSample(r,i+t,c)}A/=2,s*=l+.8,l*=.3}while(A>1)}sample(e,t){return this.values[(e&this.w-1)+(t&this.h-1)*this.w]}setSample(e,t,i){this.values[(e&this.w-1)+(t&this.h-1)*this.w]=i}}const A=(e,t)=>{const i=new r(e,t,16),A=new r(e,t,16),s=new r(e,t,16),l=new r(e,t,32),h=new r(e,t,32),o=new Array(e*t),a=new Array(e*t);for(let r=0;r<t;r++)for(let a=0;a<e;a++){const d=a+r*e;let c=3*Math.abs(l.values[d]-h.values[d])-2,g=Math.abs(i.values[d]-A.values[d]);g=3*Math.abs(g-s.values[d])-2;let f=a/(e-1)*2-1,w=r/(t-1)*2-1;f<0&&(f=-f),w<0&&(w=-w);let m=f>=w?f:w;m*=m*m*m,m*=m*m*m,c=c+1-20*m,o[d]=c<-.5?n.water.id:n.grass.id}for(let r=0;r<e*t/2800;r++){let i=Math.round(Math.random()*e),r=Math.round(Math.random()*t);for(let A=0;A<10;A++){let A=i+Math.round(21*Math.random()-10),s=r+Math.round(21*Math.random()-10);for(let i=0;i<100;i++){let i=A+Math.round(5*Math.random())-Math.round(5*Math.random()),r=s+Math.round(5*Math.random())-Math.round(5*Math.random());for(let A=r-1;A<=r+1;A++)for(let r=i-1;r<=i+1;r++)r>=0&&A>=0&&r<e&&A<t&&1==o[r+A*e]&&(o[r+A*e]=n.sand.id)}}}for(let r=0;r<e*t/400;r++){const i=Math.round(Math.random()*e),r=Math.round(Math.random()*t);for(let A=0;A<200;A++){const A=i+Math.round(15*Math.random())-Math.round(15*Math.random()),s=r+Math.round(15*Math.random())-Math.round(15*Math.random());A>=0&&s>=0&&A<e&&s<t&&o[A+s*e]==n.grass.id&&(o[A+s*e]=n.tree.id)}}let d=-1,c=-1;for(;-1===d||-1===c;){d=Math.round(Math.random()*e),c=Math.round(Math.random()*t);e:for(let t=c-1;t<=c+1;t++)for(let i=d-1;i<=d+1;i++)if(o[i+t*e]===n.water.id||o[i+t*e]===n.tree.id){d=-1,c=-1;break e}}return o[d+c*e]=n.startingPosition.id,[o,a]};class s{constructor(e){t(this,"id"),this.id=e}getOutcome(){return 0}}class l extends s{render(e,t,i,r,A,s){const l=e.getTile(i,r-1).id===this.id||e.getTile(i,r-1).id===n.tree.id,h=e.getTile(i,r+1).id===this.id||e.getTile(i,r+1).id===n.tree.id,o=e.getTile(i-1,r).id===this.id||e.getTile(i-1,r).id===n.tree.id,a=e.getTile(i+1,r).id===this.id||e.getTile(i+1,r).id===n.tree.id,d=e.getTile(i-1,r-1).id===this.id||e.getTile(i-1,r-1).id===n.tree.id,c=e.getTile(i+1,r-1).id===this.id||e.getTile(i+1,r-1).id===n.tree.id;l||o?l&&o&&!d?e.renderTile(t,32,32,i,r,A,s):e.renderTile(t,o?8:0,l?32:24,i,r,A,s):e.renderTile(t,0,24,i,r,A,s),l||a?l&&a&&!c?e.renderTile(t,24,32,i,r,A+8,s):e.renderTile(t,a?8:16,l?32:24,i,r,A+8,s):e.renderTile(t,16,24,i,r,A+8,s),h||o?e.renderTile(t,o?8:0,h?32:40,i,r,A,s+8):e.renderTile(t,0,40,i,r,A,s+8),h||a?e.renderTile(t,a?8:16,h?32:40,i,r,A+8,s+8):e.renderTile(t,16,40,i,r,A+8,s+8)}}const n={water:new class extends s{render(e,t,i,r,A,s){const l=e.getTile(i,r-1).id===this.id,n=e.getTile(i,r+1).id===this.id,h=e.getTile(i-1,r).id===this.id,o=e.getTile(i+1,r).id===this.id,a=e.getTile(i-1,r-1).id===this.id,d=e.getTile(i+1,r-1).id===this.id;l||h?l&&h&&!a?e.renderTile(t,32,8,i,r,A,s):e.renderTile(t,h?8:0,l?8:0,i,r,A,s):e.renderTile(t,0,0,i,r,A,s),l||o?l&&o&&!d?e.renderTile(t,24,8,i,r,A+8,s):e.renderTile(t,o?8:16,l?8:0,i,r,A+8,s):e.renderTile(t,16,0,i,r,A+8,s),n||h?e.renderTile(t,h?8:0,n?8:16,i,r,A,s+8):e.renderTile(t,0,16,i,r,A,s+8),n||o?e.renderTile(t,o?8:16,n?8:16,i,r,A+8,s+8):e.renderTile(t,16,16,i,r,A+8,s+8),l&&!h&&a&&e.renderTile(t,32,0,i,r,A,s-8),l&&!o&&d&&e.renderTile(t,24,0,i,r,A+8,s-8)}}(0),grass:new l(1),sand:new class extends s{render(e,t,i,r,A,s){e.renderTile(t,40,0,i,r,A,s),e.renderTile(t,40,0,i,r,A+8,s),e.renderTile(t,40,0,i,r,A,s+8),e.renderTile(t,40,0,i,r,A+8,s+8)}}(2),tree:new class extends s{render(e,t,i,r,A,s){const l=e.getTile(i,r-1).id===n.water.id||e.getTile(i,r-1).id===n.sand.id,h=e.getTile(i,r+1).id===n.water.id||e.getTile(i,r+1).id===n.sand.id,o=e.getTile(i-1,r).id===n.water.id||e.getTile(i-1,r).id===n.sand.id,a=e.getTile(i+1,r).id===n.water.id||e.getTile(i+1,r).id===n.sand.id;l&&o?e.renderTile(t,0,24,i,r,A,s):e.renderTile(t,o?0:8,l?24:32,i,r,A,s),l&&a?e.renderTile(t,16,24,i,r,A+8,s):e.renderTile(t,a?16:8,l?24:32,i,r,A+8,s),h&&o?e.renderTile(t,0,40,i,r,A,s+8):e.renderTile(t,o?0:8,h?40:32,i,r,A,s+8),h&&a?e.renderTile(t,16,40,i,r,A+8,s+8):e.renderTile(t,a?16:8,h?40:32,i,r,A+8,s+8);e.renderTile(t,16,48,i,r,A,s),e.renderTile(t,24,48,i,r,A+8,s),e.renderTile(t,16,56,i,r,A,s+8),e.renderTile(t,24,56,i,r,A+8,s+8)}getOutcome(){return 3}}(3),startingPosition:new l(999)},h=Object.entries(n).map((([e,t])=>t));var o,a;(a=o||(o={}))[a.OWNED=1]="OWNED",a[a.VISIBLE=6]="VISIBLE";let d=!1;window.onload=()=>{d=!0,P()};let c=!1,g=!1,f=0,w=0,m=0,u=0,T=0,M=0;let S=3;let v=0;const y=(e=>{const t=new Image;return v++,t.onload=()=>{v--,0===v&&P()},t.src=e,t})(i),p=document.querySelector("#map"),B=p.getContext("2d"),D=new class{constructor(){t(this,"scrollX",0),t(this,"scrollY",0),t(this,"scrollSpeed",2),t(this,"keys",[]),window.onkeydown=e=>{this.keys[e.keyCode]=!0},window.onkeyup=e=>{this.keys[e.keyCode]=!1}}update(e,t,i){return this.scrollX=e,this.scrollY=t,this.keys[87]&&(this.scrollY+=this.scrollSpeed),this.keys[65]&&(this.scrollX+=this.scrollSpeed),this.keys[83]&&(this.scrollY-=this.scrollSpeed),this.keys[68]&&(this.scrollX-=this.scrollSpeed),this.keys[27]&&i&&i(),[this.scrollX,this.scrollY]}},I=new Array(1);for(let K=0;K<I.length;K++)I[K]={name:"Base",imageX:0,imageY:6};const Q=new class{constructor(e,r){t(this,"tiles"),t(this,"tilesState"),t(this,"tileSize",16),t(this,"tileImage"),t(this,"imagesToLoad",0),t(this,"width"),t(this,"height"),this.width=e,this.height=r,this.tiles=new Array(e*r),this.tilesState=new Array(e*r),this.tileImage=this.loadImage(i)}loadImage(e){var t=new Image;return this.imagesToLoad++,t.onload=()=>{this.imagesToLoad--,0===this.imagesToLoad&&this.init()},t.src=e,t}init(){const e=((e,t)=>{for(;;){const i=A(e,t),r=new Array(256);for(let A=0;A<e*t;A++)r[255&i[0][A]]++;if(!(r[2]<100||r[1]<100))return i}})(this.width,this.height);this.tiles=e[0],this.tilesState=e[1],this.tilesState.fill(0)}render(e,t,i,r,A){const s=Math.floor(-i/this.tileSize),l=Math.floor(-r/this.tileSize),n=Math.ceil((-i+e.width/A)/this.tileSize),h=Math.ceil((-r+e.height/A)/this.tileSize);for(let o=l;o<h;o++)for(let e=s;e<n;e++){const A=this.getTile(e,o),s=this.getTileState(e,o,1);A.render(this,t,e,o,i,r),1===s&&t.drawImage(this.tileImage,0,48,16,16,e*this.tileSize+i,o*this.tileSize+r,16,16)}for(let o=l;o<h;o++)for(let e=s;e<n;e++){const A=this.getTileState(e,o,6);if(1===A)t.drawImage(this.tileImage,240,16,8,8,e*this.tileSize+i+0,o*this.tileSize+r+0,8,8),t.drawImage(this.tileImage,240,16,8,8,e*this.tileSize+i+8,o*this.tileSize+r+0,8,8),t.drawImage(this.tileImage,240,16,8,8,e*this.tileSize+i+0,o*this.tileSize+r+8,8,8),t.drawImage(this.tileImage,240,16,8,8,e*this.tileSize+i+8,o*this.tileSize+r+8,8,8);else for(let s=0;s<4;s++){const l=s%2*2-1,n=2*(s>>1)-1,h=this.getTileState(e,o+n,6)!==A,a=this.getTileState(e+l,o,6)!==A;let d=25,c=1;3===A&&(c+=3),h&&(c+=n),a&&(d+=l),t.drawImage(this.tileImage,8*d,8*c,8,8,e*this.tileSize+i+s%2*8,o*this.tileSize+r+8*(s>>1),8,8)}}}renderTile(e,t,i,r,A,s,l){e.drawImage(this.tileImage,t,i,8,8,r*this.tileSize+s,A*this.tileSize+l,8,8)}getTile(e,t){if(e<0||t<0||e>=this.width||t>=this.height)return n.water;const i=h.find((i=>this.tiles[e+t*this.width]===i.id));return null!=i?i:n.water}getTileState(e,t,i){return e<0||t<0||e>=this.width||t>=this.height?0:6===i?(this.tilesState[e+t*this.width]&i)>>1:this.tilesState[e+t*this.width]&i}setTileState(e,t,i,r){if(!(e<0||t<0||e>=this.width||t>=this.height))if(6===r){const r=this.tilesState[e+t*this.width];this.tilesState[e+t*this.width]=i<<1|1&r}else this.tilesState[e+t*this.width]^=i}setTile(e,t,i){e<0||t<0||e>=this.width||t>=this.height||(this.tiles[e+t*this.width]=i.id)}recalcVisibility(){for(let e=0;e<this.height;e++)for(let t=0;t<this.width;t++){let i=this.getTileState(t,e,6);3===i&&(i>>=1),this.setTileState(t,e,i,6)}for(let e=0;e<this.height;e++)for(let t=0;t<this.width;t++){this.getTileState(t,e,1)&&this.revealTile(t,e,4)}}revealTile(e,t,i){for(let r=t-i;r<=t+i;r++)if(!(r<0||r>=this.height))for(let A=e-i;A<=e+i;A++){if(A<0||A>=this.width)continue;const s=A-e,l=r-t;if(s*s+l*l<=i*i+2){if(0===r||0===A||A===this.width-1||r===this.height-1)continue;this.setTileState(A,r,3,6)}}}}(32,32),P=()=>{if(d&&!(v>0)){p.width=window.innerWidth,p.height=window.innerHeight,p.onmousedown=e=>{e.preventDefault(),c=!0,g=!1,f=e.clientX,w=e.clientY},p.onclick=e=>{if(c=!1,!g){const t=Math.floor(m+16*-T+window.innerWidth/S/2),i=Math.floor(u+16*-M+window.innerHeight/S/2),r=Math.floor((e.clientX/S-t)/16),A=Math.floor((e.clientY/S-i)/16);X(r,A,e.clientX/S,e.clientY/S)}};for(let e=0;e<32;e++)for(let t=0;t<32;t++){const i=t+32*e;Q.tiles[i]===n.startingPosition.id&&(T=t,M=e,Q.setTileState(T,M,1,o.OWNED),Q.recalcVisibility())}window.onmousemove=e=>{if(c){e.preventDefault();var t=e.clientX-f,i=e.clientY-w;(g||t*t+i*i>64)&&(g=!0,m+=t/S,u+=i/S,f=e.clientX,w=e.clientY,requestAnimationFrame(k))}},b(),k()}};let H=-1,C=-1,L=!1,z=!1;const X=(e,t,i,r)=>{const A=Math.floor(B.canvas.width/S),s=Math.floor(B.canvas.height/S);if(i>=0&&i<=A&&r>=s-35&&r<=s)U(i,r);else{if(e<0||t<0||e>32||t>32)return H=-1,void(C=-1);if(H!==e||C!==t){H=e,C=t,L=!0;const i=Q.getTileState(e,t,o.VISIBLE);z=3===i}requestAnimationFrame(k)}},b=()=>{requestAnimationFrame(b);const e=D.update(m,u,(()=>{L=!1,requestAnimationFrame(k)}));m===e[0]&&u===e[1]||(m=e[0],u=e[1],requestAnimationFrame(k))},k=()=>{S=Math.max(Math.floor(p.height/300+1),Math.floor(p.width/(16/9*300)+1)),m>16*T&&(m=16*T),u>16*M&&(u=16*M),m<16*T-480&&(m=16*T-480),u<16*M-480&&(u=16*M-480),B.imageSmoothingEnabled=!1,B.setTransform(S,0,0,S,0,0);const e=Math.floor(m+16*-T+window.innerWidth/S/2),t=Math.floor(u+16*-M+window.innerHeight/S/2);Q.render(p,B,e,t,S);for(var i=0;i<I.length;i++){const e=Math.floor(B.canvas.width/S),t=Math.floor(B.canvas.height/S);B.fillStyle="rgba(255, 255, 255, 0.3)",B.fillRect(0,t-35,e,t),q(I[i].name,e/2+2,t-25-5,3),Y(I[i].imageX,I[i].imageY,e/2,t-25)}if(L&&(B.strokeStyle="white",B.strokeRect(16*H+e,16*C+t,16,16),z)){const i=Q.getTile(H,C);q(`Outcome: ${i.getOutcome()}`,16*H+e+18,16*C+t+6,4)}},O="ABCDEFGHIJKLMNOPQRSTUVWXYZ      0123456789.,!?'\":;()+-=*/\\%     ",q=(e,t,i,r=8)=>{e=e.toUpperCase();for(var A=0;A<e.length;A++){var s=O.indexOf(e.charAt(A)),l=0+s%32,n=29+(s>>5);B.drawImage(y,8*l,8*n,8,8,t+A*r,i,r,r)}},U=(e,t)=>{const i=Math.floor(B.canvas.width/S)/2,r=Math.floor(B.canvas.height/S)-25;e>=i&&e<=i+16&&t>=r&&t<=r+16&&(Q.setTileState(H,C,1,o.OWNED),Q.recalcVisibility(),requestAnimationFrame(k),H=-1,C=-1)},Y=(e,t,i,r)=>{B.beginPath(),B.strokeStyle="yellow",B.rect(i,r,16,16),B.stroke(),B.drawImage(y,8*e,8*t,16,16,i,r,16,16)};
