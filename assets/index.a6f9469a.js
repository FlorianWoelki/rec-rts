var e=Object.defineProperty,A=("undefined"!=typeof require&&require,(A,t,r)=>(((A,t,r)=>{t in A?e(A,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):A[t]=r})(A,"symbol"!=typeof t?t+"":t,r),r));!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))A(e);new MutationObserver((e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&A(e)})).observe(document,{childList:!0,subtree:!0})}function A(e){if(e.ep)return;e.ep=!0;const A=function(e){const A={};return e.integrity&&(A.integrity=e.integrity),e.referrerpolicy&&(A.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?A.credentials="include":"anonymous"===e.crossorigin?A.credentials="omit":A.credentials="same-origin",A}(e);fetch(e.href,A)}}();var t="data:image/png;base64,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";class r{constructor(e,t,r){A(this,"w"),A(this,"h"),A(this,"values"),this.w=e,this.h=t,this.values=new Array(e*t);for(let A=0;A<t;A+=r)for(let t=0;t<e;t+=r)this.setSample(t,A,2*Math.random()-1);let i=r,s=1/e,n=1;do{const A=i/2;for(let r=0;r<t;r+=i)for(let t=0;t<e;t+=i){const e=(this.sample(t,r)+this.sample(t+i,r)+this.sample(t,r+i)+this.sample(t+i,r+i))/4+(2*Math.random()-1)*i*s;this.setSample(t+A,r+A,e)}for(let t=0;t<e;t+=i)for(let r=0;r<e;r+=i){const e=this.sample(r,t),n=this.sample(r+i,t),o=this.sample(r,t+i),l=this.sample(r+A,t+A),a=this.sample(r+A,t-A),h=this.sample(r-A,t+A),d=(e+n+l+a)/4+(2*Math.random()-1)*i*s*.5,c=(e+o+l+h)/4+(2*Math.random()-1)*i*s*.5;this.setSample(r+A,t,d),this.setSample(r,t+A,c)}i/=2,s*=n+.8,n*=.3}while(i>1)}sample(e,A){return this.values[(e&this.w-1)+(A&this.h-1)*this.w]}setSample(e,A,t){this.values[(e&this.w-1)+(A&this.h-1)*this.w]=t}}const i=(e,A)=>{const t=new r(e,A,16),i=new r(e,A,16),s=new r(e,A,16),o=new r(e,A,32),l=new r(e,A,32),a=new Array(e*A),h=new Array(e*A);for(let r=0;r<A;r++)for(let h=0;h<e;h++){const d=h+r*e;let c=3*Math.abs(o.values[d]-l.values[d])-2,f=Math.abs(t.values[d]-i.values[d]);f=3*Math.abs(f-s.values[d])-2;let g=h/(e-1)*2-1,w=r/(A-1)*2-1;g<0&&(g=-g),w<0&&(w=-w);let m=g>=w?g:w;m*=m*m*m,m*=m*m*m,c=c+1-20*m,a[d]=c<-.5?n.water.id:n.grass.id}for(let r=0;r<e*A/2800;r++){let t=Math.round(Math.random()*e),r=Math.round(Math.random()*A);for(let i=0;i<10;i++){let i=t+Math.round(21*Math.random()-10),s=r+Math.round(21*Math.random()-10);for(let t=0;t<100;t++){let t=i+Math.round(5*Math.random())-Math.round(5*Math.random()),r=s+Math.round(5*Math.random())-Math.round(5*Math.random());for(let i=r-1;i<=r+1;i++)for(let r=t-1;r<=t+1;r++)r>=0&&i>=0&&r<e&&i<A&&1==a[r+i*e]&&(a[r+i*e]=n.sand.id)}}}for(let r=0;r<e*A/400;r++){const t=Math.round(Math.random()*e),r=Math.round(Math.random()*A);for(let i=0;i<200;i++){const i=t+Math.round(15*Math.random())-Math.round(15*Math.random()),s=r+Math.round(15*Math.random())-Math.round(15*Math.random());i>=0&&s>=0&&i<e&&s<A&&a[i+s*e]==n.grass.id&&(a[i+s*e]=n.tree.id)}}return[a,h]};class s{constructor(e){A(this,"id"),A(this,"isOwned",!1),A(this,"visible",0),this.id=e}}const n={water:new class extends s{render(e,A,t,r,i,s){const n=e.getTile(t,r-1).id===this.id,o=e.getTile(t,r+1).id===this.id,l=e.getTile(t-1,r).id===this.id,a=e.getTile(t+1,r).id===this.id,h=e.getTile(t-1,r-1).id===this.id,d=e.getTile(t+1,r-1).id===this.id;n||l?n&&l&&!h?e.renderTile(A,32,8,t,r,i,s):e.renderTile(A,l?8:0,n?8:0,t,r,i,s):e.renderTile(A,0,0,t,r,i,s),n||a?n&&a&&!d?e.renderTile(A,24,8,t,r,i+8,s):e.renderTile(A,a?8:16,n?8:0,t,r,i+8,s):e.renderTile(A,16,0,t,r,i+8,s),o||l?e.renderTile(A,l?8:0,o?8:16,t,r,i,s+8):e.renderTile(A,0,16,t,r,i,s+8),o||a?e.renderTile(A,a?8:16,o?8:16,t,r,i+8,s+8):e.renderTile(A,16,16,t,r,i+8,s+8),n&&!l&&h&&e.renderTile(A,32,0,t,r,i,s-8),n&&!a&&d&&e.renderTile(A,24,0,t,r,i+8,s-8)}}(0),grass:new class extends s{render(e,A,t,r,i,s){e.renderTile(A,8,32,t,r,i,s),e.renderTile(A,8,32,t,r,i+8,s),e.renderTile(A,8,32,t,r,i,s+8),e.renderTile(A,8,32,t,r,i+8,s+8)}}(1),sand:new class extends s{render(e,A,t,r,i,s){e.renderTile(A,40,0,t,r,i,s),e.renderTile(A,40,0,t,r,i+8,s),e.renderTile(A,40,0,t,r,i,s+8),e.renderTile(A,40,0,t,r,i+8,s+8)}}(2),tree:new class extends s{render(e,A,t,r,i,s){e.renderTile(A,8,32,t,r,i,s),e.renderTile(A,8,32,t,r,i+8,s),e.renderTile(A,8,32,t,r,i,s+8),e.renderTile(A,8,32,t,r,i+8,s+8),e.renderTile(A,16,48,t,r,i,s),e.renderTile(A,24,48,t,r,i+8,s),e.renderTile(A,16,56,t,r,i,s+8),e.renderTile(A,24,56,t,r,i+8,s+8)}}(3)},o=Object.entries(n).map((([,e])=>e));let l=!1;window.onload=()=>{l=!0,Q()},window.onresize=Q;let a=!1,h=!1,d=0,c=0,f=0,g=0;var w=3;var m,u,v=(m=t,u=new Image,M++,u.onload=function(){0==--M&&Q()},u.src=m,u),M=0;const T=document.querySelector("#map"),p=T.getContext("2d"),D=new class{constructor(){A(this,"scrollX",0),A(this,"scrollY",0),A(this,"scrollSpeed",2),A(this,"keys",[]),window.onkeydown=e=>{this.keys[e.keyCode]=!0},window.onkeyup=e=>{this.keys[e.keyCode]=!1,this.scrollX=0,this.scrollY=0}}update(e){this.keys[87]&&(this.scrollY+=this.scrollSpeed,e()),this.keys[65]&&(this.scrollX+=this.scrollSpeed,e()),this.keys[83]&&(this.scrollY-=this.scrollSpeed,e()),this.keys[68]&&(this.scrollX-=this.scrollSpeed,e())}};var B=new Array(6);for(let S=0;S<B.length;S++)B[S]={name:"Base",imageX:0,imageY:6};const y=new class{constructor(e,r){A(this,"tiles"),A(this,"tileSize",16),A(this,"tileImage"),A(this,"imagesToLoad",0),A(this,"width"),A(this,"height"),this.width=e,this.height=r,this.tiles=new Array(e*r),this.tileImage=this.loadImage(t)}loadImage(e){var A=new Image;return this.imagesToLoad++,A.onload=()=>{this.imagesToLoad--,0===this.imagesToLoad&&this.init()},A.src=e,A}init(){const e=((e,A)=>{for(;;){const t=i(e,A),r=new Array(256);for(let i=0;i<e*A;i++)r[255&t[0][i]]++;if(!(r[2]<100||r[1]<100))return t}})(this.width,this.height);this.tiles=e[0]}render(e,A,t,r,i){const s=Math.floor(-t/this.tileSize),n=Math.floor(-r/this.tileSize),o=Math.ceil((-t+e.width/i)/this.tileSize),l=Math.ceil((-r+e.height/i)/this.tileSize);for(let a=n;a<l;a++)for(let e=s;e<o;e++)this.getTile(e,a).render(this,A,e,a,t,r)}renderTile(e,A,t,r,i,s,n){e.drawImage(this.tileImage,A,t,8,8,r*this.tileSize+s,i*this.tileSize+n,8,8)}getTile(e,A){return e<0||A<0||e>=this.width||A>=this.height?n.water:o[this.tiles[e+A*this.width]]}setTile(e,A,t){e<0||A<0||e>=this.width||A>=this.height||(this.tiles[e+A*this.width]=t.id)}}(128,128);async function Q(){if(l&&!(M>0)){T.width=window.innerWidth,T.height=window.innerHeight,T.onmousedown=function(e){e.preventDefault(),a=!0,h=!1,d=e.clientX,c=e.clientY},T.onclick=function(e){if(a=!1,!h){var A=Math.floor(f+(T.width/w-2048)/2),t=Math.floor(g+(T.height/w-2048)/2);C(Math.floor((e.clientX/w-A)/16),Math.floor((e.clientY/w-t)/16))}};var e=Math.floor(f+(T.width/w-2048)/2),A=Math.floor(g+(T.height/w-2048)/2);C(Math.floor((800/w-e)/16),Math.floor((600/w-A)/16)),window.onmousemove=function(e){if(a){e.preventDefault();var A=e.clientX-d,t=e.clientY-c;(h||A*A+t*t>64)&&(h=!0,f+=A/w,g+=t/w,d=e.clientX,c=e.clientY,requestAnimationFrame(L))}},H()}}function C(e,A){if(e>0&&A>0&&e<128&&A<128){var t=y.getTile(e,A);t.isOwned=!t.isOwned,function(){for(var e=0;e<128;e++)for(var A=0;A<128;A++){y.getTile(A,e).visible&=1}for(e=0;e<128;e++)for(A=0;A<128;A++){y.getTile(A,e).isOwned&&P(A,e,4)}}()}requestAnimationFrame(L)}function P(e,A,t){for(var r=A-t;r<=A+t;r++)if(!(r<0||r>=128))for(var i=e-t;i<=e+t;i++)if(!(i<0||i>=128)){var s=i-e,n=r-A;if(s*s+n*n<=t*t+2){if(0===r||0===i||127===i||127===r)continue;y.getTile(i,r).visible=3}}}const H=()=>{0!==D.scrollX&&(f=D.scrollX),0!==D.scrollY&&(g=D.scrollY),requestAnimationFrame(H),D.update(L)};function L(){w=Math.max(Math.floor(T.height/300+1),Math.floor(T.width/(16/9*300)+1));var e=Math.max(0,2112-T.width/w)/2,A=Math.max(0,2112-T.height/w)/2;f<-e&&(f=-e),g<-A&&(g=-A),f>e&&(f=e),g>A&&(g=A),p.imageSmoothingEnabled=!1,p.setTransform(w,0,0,w,0,0);const t=Math.floor(f+(T.width/w-2048)/2),r=Math.floor(g+(T.height/w-2048)/2);y.render(T,p,t,r,w),b("GOLD: 500",4,4),b("FOOD: 0/100",4,14),p.beginPath(),p.fillStyle="rgba(255, 255, 255, 0.3)",p.fillRect(0,30,24,24*B.length+6),p.stroke();for(var i=0;i<B.length;i++)b(B[i].name,6,34+24*i,3),O(B[i].imageX,B[i].imageY,4,38+24*i)}var X="ABCDEFGHIJKLMNOPQRSTUVWXYZ      0123456789.,!?'\":;()+-=*/\\%     ";function b(e,A,t,r=8){e=e.toUpperCase();for(var i=0;i<e.length;i++){var s=X.indexOf(e.charAt(i)),n=0+s%32,o=29+(s>>5);p.drawImage(v,8*n,8*o,8,8,A+i*r,t,r,r)}}function O(e,A,t,r){p.beginPath(),p.strokeStyle="yellow",p.rect(t,r,16,16),p.stroke(),p.drawImage(v,8*e,8*A,16,16,t,r,16,16)}
